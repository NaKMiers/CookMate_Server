openapi: 3.0.3
info:
  title: CookMate API
  description: |
    CookMate API - A comprehensive cooking and recipe management platform.
    
    ## Features
    - User authentication with Google OAuth and Email OTP
    - Recipe search and management
    - Ingredient tracking and pantry management
    - Shopping list functionality
    - Favorites system
    - User profile management
    - Meal planning
    - Notifications system
    - Account recovery
    
    ## Authentication
    Most endpoints require Bearer token authentication. Get your token by calling the authentication endpoints.
    
    **Authentication Required Endpoints:**
    - `/api` - API Welcome message
    - `/api/ai` - AI Chat Assistant (OpenAI GPT-4o-mini with tool calling)
    - `/api/admin/users` - Admin: User management (requires admin role)
    - `/api/ingredients` - All CRUD operations
    - `/api/ingredient-categories` - All CRUD operations
    - `/api/favorites` - All CRUD operations  
    - `/api/profile` - All CRUD operations
    - `/api/profile/delete` - Delete account
    - `/api/shopping` - All CRUD operations
    - `/api/recipes/search` - Recipe search
    - `/api/recipes/today` - Today's recipes
    - `/api/meal-plans` - All CRUD operations
    - `/api/notifications` - All CRUD operations
    
    **No Authentication Required:**
    - `/api/auth/google` - Google authentication
    - `/api/auth/otp` - Send OTP for email authentication
    - `/api/auth/otp/verify` - Verify OTP for email authentication
    - `/api/auth/recover` - Send recovery OTP
    - `/api/auth/recover/verify` - Verify recovery OTP
    - `/api/recipes/bulk` - Get recipes by IDs
    
    ## Base URLs
    - Development: `http://localhost:3000`
    - Production: `https://cookm8.vercel.app`
    
    **Environment Variables:**
    - `NEXT_PUBLIC_APP_URL` - Base URL for API requests
  version: 1.0.0
  contact:
    name: CookMate Team
    email: support@cookmate.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:3000
    description: Development server
  - url: https://cookm8.vercel.app
    description: Production server

security:
  - BearerAuth: []

paths:
  /api:
    get:
      tags:
        - General
      summary: API Welcome
      description: Get welcome message from CookMate API (Requires Authentication)
      responses:
        '200':
          description: Welcome message
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Hello, Welcome to CookMate API!"
              example:
                message: "Hello, Welcome to CookMate API!"
        '401':
          $ref: '#/components/responses/Unauthorized'

  /api/auth/google:
    post:
      tags:
        - Authentication
      summary: Google Authentication
      description: Authenticate user with Google OAuth and get JWT token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - googleUserId
                - email
              properties:
                googleUserId:
                  type: string
                  description: Google user ID
                  example: "123456789"
                email:
                  type: string
                  format: email
                  description: User email address
                  example: "user@example.com"
                name:
                  type: string
                  description: User display name
                  example: "John Doe"
                avatar:
                  type: string
                  format: uri
                  description: User avatar URL
                  example: "https://example.com/avatar.jpg"
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Google authentication successful"
                  user:
                    $ref: '#/components/schemas/User'
                  token:
                    type: string
                    description: JWT token for authentication
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/otp:
    post:
      tags:
        - Authentication
      summary: Send OTP for Email Authentication
      description: Send OTP code to user's email for authentication
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: User email address
                  example: "user@example.com"
      responses:
        '200':
          description: OTP sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "OTP sent to email"
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/otp/verify:
    post:
      tags:
        - Authentication
      summary: Verify OTP for Email Authentication
      description: Verify OTP code and authenticate user
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - otp
              properties:
                email:
                  type: string
                  format: email
                  description: User email address
                  example: "user@example.com"
                otp:
                  type: string
                  description: OTP code received via email
                  example: "123456"
      responses:
        '200':
          description: OTP verification successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Email authentication successful"
                  user:
                    $ref: '#/components/schemas/User'
                  token:
                    type: string
                    description: JWT token for authentication
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/recover:
    post:
      tags:
        - Authentication
      summary: Send Recovery OTP
      description: Send OTP code to recover deleted account
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: User email address
                  example: "user@example.com"
      responses:
        '200':
          description: Recovery OTP sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "OTP sent to email"
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/auth/recover/verify:
    post:
      tags:
        - Authentication
      summary: Verify Recovery OTP
      description: Verify recovery OTP and restore deleted account
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - otp
              properties:
                email:
                  type: string
                  format: email
                  description: User email address
                  example: "user@example.com"
                otp:
                  type: string
                  description: Recovery OTP code received via email
                  example: "123456"
      responses:
        '200':
          description: Account recovered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Account recovered successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/recipes/search:
    get:
      tags:
        - Recipes
      summary: Search Recipes
      description: Search for recipes using various parameters (Requires Authentication)
      parameters:
        - name: query
          in: query
          description: Search query for recipes
          required: false
          schema:
            type: string
            example: "pasta"
        - name: number
          in: query
          description: Number of recipes to return
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: cuisine
          in: query
          description: Cuisine type
          required: false
          schema:
            type: string
            example: "italian"
        - name: diet
          in: query
          description: Dietary restrictions
          required: false
          schema:
            type: string
            example: "vegetarian"
        - name: maxReadyTime
          in: query
          description: Maximum cooking time in minutes
          required: false
          schema:
            type: integer
            example: 30
      responses:
        '200':
          description: Recipes retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Recipes retrieved successfully"
                  recipes:
                    type: array
                    items:
                      $ref: '#/components/schemas/Recipe'
                  totalResults:
                    type: integer
                    example: 50
        '401':
          $ref: '#/components/responses/Unauthorized'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/recipes/today:
    get:
      tags:
        - Recipes
      summary: Get Today's Recipes
      description: Get random recipes for today's meal planning (Requires Authentication)
      responses:
        '200':
          description: Today's recipes retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Recipes retrieved successfully"
                  recipes:
                    type: array
                    items:
                      $ref: '#/components/schemas/Recipe'
                  totalResults:
                    type: integer
                    example: 5
        '401':
          $ref: '#/components/responses/Unauthorized'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/recipes/bulk:
    post:
      tags:
        - Recipes
      summary: Get Recipes by IDs
      description: Get multiple recipes by their IDs (No Authentication Required)
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - recipeIds
              properties:
                recipeIds:
                  type: array
                  items:
                    type: integer
                  description: Array of recipe IDs
                  example: [12345, 67890, 11111]
      responses:
        '200':
          description: Recipes retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Recipes retrieved successfully"
                  recipes:
                    type: array
                    items:
                      $ref: '#/components/schemas/Recipe'
                  totalResults:
                    type: integer
                    example: 3
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/ingredients:
    get:
      tags:
        - Ingredients
      summary: Get User Ingredients
      description: Get all ingredients for the authenticated user
      responses:
        '200':
          description: Ingredients retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredients:
                    type: array
                    items:
                      $ref: '#/components/schemas/Ingredient'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Ingredients
      summary: Add Ingredient
      description: Add a new ingredient to user's pantry
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - name
                - categoryId
                - quantity
                - unit
              properties:
                name:
                  type: string
                  description: Ingredient name
                  example: "Tomato"
                categoryId:
                  type: string
                  description: Category ID
                  example: "vegetables"
                quantity:
                  type: string
                  description: Quantity
                  example: "5"
                unit:
                  type: string
                  description: Unit of measurement
                  example: "pieces"
                expiryDate:
                  type: string
                  format: date
                  description: Expiry date
                  example: "2024-12-31"
                notes:
                  type: string
                  description: Additional notes
                  example: "Fresh tomatoes"
                image:
                  type: string
                  format: binary
                  description: Ingredient image
      responses:
        '200':
          description: Ingredient added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredient:
                    $ref: '#/components/schemas/Ingredient'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Ingredients
      summary: Update Ingredient
      description: Update an existing ingredient
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - ingredientId
                - name
                - categoryId
                - quantity
                - unit
              properties:
                ingredientId:
                  type: string
                  description: Ingredient ID to update
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
                name:
                  type: string
                  description: Ingredient name
                  example: "Red Tomato"
                categoryId:
                  type: string
                  description: Category ID
                  example: "vegetables"
                quantity:
                  type: string
                  description: Quantity
                  example: "3"
                unit:
                  type: string
                  description: Unit of measurement
                  example: "pieces"
                expiryDate:
                  type: string
                  format: date
                  description: Expiry date
                  example: "2024-12-25"
                notes:
                  type: string
                  description: Additional notes
                  example: "Updated notes"
                image:
                  type: string
                  format: binary
                  description: New ingredient image
      responses:
        '200':
          description: Ingredient updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredient:
                    $ref: '#/components/schemas/Ingredient'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Ingredients
      summary: Delete Ingredient
      description: Delete an ingredient from user's pantry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - ingredientId
              properties:
                ingredientId:
                  type: string
                  description: Ingredient ID to delete
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
      responses:
        '200':
          description: Ingredient deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredient:
                    $ref: '#/components/schemas/Ingredient'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/ingredient-categories:
    get:
      tags:
        - Ingredient Categories
      summary: Get Ingredient Categories
      description: Get all ingredient categories for the authenticated user
      responses:
        '200':
          description: Categories retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredientCategory:
                    type: array
                    items:
                      $ref: '#/components/schemas/IngredientCategory'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Ingredient Categories
      summary: Add Ingredient Category
      description: Add a new ingredient category
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Category name
                  example: "Vegetables"
                icon:
                  type: string
                  description: Category icon
                  example: "🥕"
      responses:
        '200':
          description: Category added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredientCategory:
                    $ref: '#/components/schemas/IngredientCategory'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Ingredient Categories
      summary: Update Ingredient Category
      description: Update an existing ingredient category
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - ingredientCategoryId
                - name
              properties:
                ingredientCategoryId:
                  type: string
                  description: Category ID to update
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
                name:
                  type: string
                  description: Category name
                  example: "Fresh Vegetables"
                icon:
                  type: string
                  description: Category icon
                  example: "🥬"
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredientCategory:
                    $ref: '#/components/schemas/IngredientCategory'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Ingredient Categories
      summary: Delete Ingredient Category
      description: Delete an ingredient category and all its ingredients
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - ingredientCategoryId
              properties:
                ingredientCategoryId:
                  type: string
                  description: Category ID to delete
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
      responses:
        '200':
          description: Category deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingredientCategory:
                    $ref: '#/components/schemas/IngredientCategory'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/meal-plans:
    get:
      tags:
        - Meal Plans
      summary: Get Meal Plans
      description: Get all meal plans for the authenticated user
      responses:
        '200':
          description: Meal plans retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  mealPlans:
                    type: array
                    items:
                      $ref: '#/components/schemas/MealPlan'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Meal Plans
      summary: Create Meal Plan
      description: Create a new meal plan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - date
              properties:
                name:
                  type: string
                  description: Meal plan name
                  example: "Monday Healthy Breakfast"
                recipeIds:
                  type: array
                  items:
                    type: string
                  description: Array of recipe IDs
                  example: ["recipe_123", "recipe_456"]
                notes:
                  type: string
                  description: Additional notes
                  example: "Focus on protein and vegetables"
                date:
                  type: string
                  format: date-time
                  description: Meal plan date
                  example: "2025-10-11T08:00:00.000Z"
      responses:
        '200':
          description: Meal plan created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  mealPlan:
                    $ref: '#/components/schemas/MealPlan'
                  message:
                    type: string
                    example: "Meal plan created successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Meal Plans
      summary: Update Meal Plan
      description: Update an existing meal plan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mealPlanId
                - name
                - date
              properties:
                mealPlanId:
                  type: string
                  description: Meal plan ID to update
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
                name:
                  type: string
                  description: Meal plan name
                  example: "Updated Monday Breakfast"
                recipeIds:
                  type: array
                  items:
                    type: string
                  description: Array of recipe IDs
                  example: ["recipe_789", "recipe_012"]
                notes:
                  type: string
                  description: Additional notes
                  example: "Updated focus on nutrition"
                date:
                  type: string
                  format: date-time
                  description: Meal plan date
                  example: "2025-10-11T09:00:00.000Z"
      responses:
        '200':
          description: Meal plan updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  mealPlan:
                    $ref: '#/components/schemas/MealPlan'
                  message:
                    type: string
                    example: "Meal plan updated successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Meal Plans
      summary: Delete Meal Plan
      description: Delete an existing meal plan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mealPlanId
              properties:
                mealPlanId:
                  type: string
                  description: Meal plan ID to delete
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
      responses:
        '200':
          description: Meal plan deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Meal plan deleted successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/notifications:
    get:
      tags:
        - Notifications
      summary: Get Notifications
      description: Get all notifications for the authenticated user
      responses:
        '200':
          description: Notifications retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  notifications:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    patch:
      tags:
        - Notifications
      summary: Update Notification
      description: Update notification read status (single or all)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
                - value
              properties:
                id:
                  type: string
                  description: Notification ID or 'all' for all notifications
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
                value:
                  type: boolean
                  description: Read status
                  example: true
      responses:
        '200':
          description: Notification updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Notification updated successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Notifications
      summary: Delete Notification
      description: Delete notification(s)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id
              properties:
                id:
                  type: string
                  description: Notification ID or 'all' for all notifications
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
      responses:
        '200':
          description: Notification deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Notification deleted successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/favorites:
    get:
      tags:
        - Favorites
      summary: Get User Favorites
      description: Get all favorite recipes for the authenticated user
      responses:
        '200':
          description: Favorites retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  recipes:
                    type: array
                    items:
                      $ref: '#/components/schemas/Recipe'
                  totalResults:
                    type: integer
                    example: 10
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Favorites
      summary: Add Favorite
      description: Add a recipe to user's favorites
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - recipeId
              properties:
                recipeId:
                  type: string
                  description: Recipe ID to add to favorites
                  example: "12345"
      responses:
        '200':
          description: Favorite added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Favorite added successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Favorites
      summary: Remove Favorite
      description: Remove a recipe from user's favorites
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - recipeId
              properties:
                recipeId:
                  type: string
                  description: Recipe ID to remove from favorites
                  example: "12345"
      responses:
        '200':
          description: Favorite removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Favorite deleted successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/profile:
    get:
      tags:
        - Profile
      summary: Get User Profile
      description: Get authenticated user's profile information
      responses:
        '200':
          description: Profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Profile
      summary: Update User Profile
      description: Update authenticated user's profile information
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: User's display name
                  example: "John Doe"
                avatar:
                  type: string
                  format: uri
                  description: User's avatar URL
                  example: "https://example.com/avatar.jpg"
                dietaryPreferences:
                  type: array
                  items:
                    type: string
                  description: User's dietary preferences
                  example: ["vegetarian", "gluten-free"]
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/profile/delete:
    delete:
      tags:
        - Profile
      summary: Delete Account
      description: Soft delete the authenticated user's account
      responses:
        '200':
          description: Account deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Account deleted successfully"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/admin/users:
    get:
      tags:
        - Admin
      summary: Get All Users (Admin Only)
      description: |
        Get all users with pagination, search, and filtering options.
        Requires admin role.
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            example: 1
        - name: search
          in: query
          description: Search query (searches in email, name, authType, role)
          schema:
            type: string
            example: "john"
        - name: sort
          in: query
          description: Sort field and order (format field|order, where order is 1 for asc or -1 for desc)
          schema:
            type: string
            example: "updatedAt|-1"
        - name: role
          in: query
          description: Filter by role
          schema:
            type: string
            enum: [user, admin]
            example: "user"
      responses:
        '200':
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  users:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  amount:
                    type: integer
                    description: Total number of users
                    example: 50
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Admin
      summary: Delete Users (Admin Only)
      description: |
        Soft delete users by IDs or emails. Requires admin role.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                  description: Array of user IDs to delete
                  example: ["64f1a2b3c4d5e6f7g8h9i0j1"]
                emails:
                  type: array
                  items:
                    type: string
                  description: Array of user emails to delete
                  example: ["user@example.com"]
                value:
                  type: boolean
                  description: Set isDeleted flag (default true)
                  default: true
                  example: true
      responses:
        '200':
          description: Users deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Users deleted successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/ai:
    post:
      tags:
        - AI Assistant
      summary: Chat with CookMate AI Assistant
      description: |
        Send messages to CookMate AI Assistant for help with recipes, meal planning, ingredients, shopping lists, and more.
        The AI can call various tools to help you manage your cooking activities.
        
        **Available AI Tools:**
        - Profile: get_profile
        - Favorites: get_all_favorites
        - Meal Plans: get_all_meal_plans
        - Ingredients: get_all_ingredients
        - Ingredient Categories: get_all_ingredient_categories, add_ingredient_category
        - Shopping List: get_shopping_list, add_shopping_item
        
        **Example Queries:**
        - "Show my shopping list"
        - "Add milk to shopping list"
        - "What are my favorite recipes?"
        - "Show my meal plans"
        - "Create category Vegetables with icon 🥬"
        - "Show my profile"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - messages
              properties:
                messages:
                  type: array
                  items:
                    type: object
                    properties:
                      role:
                        type: string
                        enum: [user, assistant, tool]
                        description: Message role
                      content:
                        type: string
                        description: Message content
                      toolInvocations:
                        type: object
                        description: Tool invocations (for assistant messages with tool calls)
                  description: Conversation history
                  example:
                    - role: user
                      content: "Show my shopping list"
      responses:
        '200':
          description: AI response generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      role:
                        type: string
                        example: "assistant"
                      content:
                        type: string
                        example: "Here's your shopping list..."
                      toolInvocations:
                        type: object
                        description: Tool results if AI called tools
                  usage:
                    type: object
                    properties:
                      inputTokens:
                        type: integer
                      outputTokens:
                        type: integer
                      totalTokens:
                        type: integer
                  finishReason:
                    type: string
                    example: "stop"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/shopping:
    get:
      tags:
        - Shopping
      summary: Get Shopping List
      description: Get user's shopping list
      responses:
        '200':
          description: Shopping list retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  shoppingList:
                    type: array
                    items:
                      $ref: '#/components/schemas/ShoppingItem'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    post:
      tags:
        - Shopping
      summary: Add Shopping Item
      description: Add a new item to user's shopping list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Item name
                  example: "Milk"
                status:
                  type: string
                  enum: [draft, active, completed, cancelled]
                  description: Item status
                  default: draft
                  example: "draft"
                notes:
                  type: string
                  description: Additional notes
                  example: "2% milk"
      responses:
        '200':
          description: Shopping item added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  shoppingItem:
                    $ref: '#/components/schemas/ShoppingItem'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'

    put:
      tags:
        - Shopping
      summary: Update Shopping Item
      description: Update an existing shopping list item
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - shoppingItemId
                - name
              properties:
                shoppingItemId:
                  type: string
                  description: Shopping item ID to update
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
                name:
                  type: string
                  description: Item name
                  example: "Organic Milk"
                status:
                  type: string
                  enum: [draft, active, completed, cancelled]
                  description: Item status
                  example: "completed"
                notes:
                  type: string
                  description: Additional notes
                  example: "Organic 2% milk"
      responses:
        '200':
          description: Shopping item updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  shoppingItem:
                    $ref: '#/components/schemas/ShoppingItem'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags:
        - Shopping
      summary: Delete Shopping Item
      description: Delete an item from user's shopping list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - shoppingItemId
              properties:
                shoppingItemId:
                  type: string
                  description: Shopping item ID to delete
                  example: "64f1a2b3c4d5e6f7g8h9i0j1"
      responses:
        '200':
          description: Shopping item deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Shopping item deleted successfully"
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT token obtained from authentication endpoints.
        Include the token in the Authorization header as: `Bearer <token>`

  schemas:
    User:
      type: object
      properties:
        _id:
          type: string
          description: User ID
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        email:
          type: string
          format: email
          description: User email
          example: "user@example.com"
        name:
          type: string
          description: User display name
          example: "John Doe"
        avatar:
          type: string
          format: uri
          description: User avatar URL
          example: "https://example.com/avatar.jpg"
        dietaryPreferences:
          type: array
          items:
            type: string
          description: User's dietary preferences
          example: ["vegetarian", "gluten-free"]
        googleUserId:
          type: string
          description: Google user ID
          example: "123456789"
        authType:
          type: string
          enum: [google, email]
          description: Authentication type
          example: "google"
        role:
          type: string
          enum: [user, admin]
          description: User role
          default: user
          example: "user"
        isDeleted:
          type: boolean
          description: Account deletion status
          example: false
        createdAt:
          type: string
          format: date-time
          description: Account creation date
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update date
          example: "2024-01-15T10:30:00Z"

    Recipe:
      type: object
      properties:
        id:
          type: string
          description: Recipe ID
          example: "12345"
        title:
          type: string
          description: Recipe title
          example: "Spaghetti Carbonara"
        image:
          type: string
          format: uri
          description: Recipe image URL
          example: "https://example.com/recipe.jpg"
        readyInMinutes:
          type: integer
          description: Cooking time in minutes
          example: 30
        servings:
          type: integer
          description: Number of servings
          example: 4
        summary:
          type: string
          description: Recipe summary
          example: "A classic Italian pasta dish..."
        instructions:
          type: array
          items:
            type: string
          description: Cooking instructions
          example: ["Boil water", "Add pasta", "Cook for 10 minutes"]
        ingredients:
          type: array
          items:
            $ref: '#/components/schemas/RecipeIngredient'
        nutrition:
          $ref: '#/components/schemas/Nutrition'
        cuisines:
          type: array
          items:
            type: string
          description: Cuisine types
          example: ["Italian", "Mediterranean"]
        diets:
          type: array
          items:
            type: string
          description: Dietary tags
          example: ["vegetarian", "gluten-free"]

    RecipeIngredient:
      type: object
      properties:
        id:
          type: string
          description: Ingredient ID
          example: "123"
        name:
          type: string
          description: Ingredient name
          example: "Spaghetti"
        amount:
          type: number
          description: Ingredient amount
          example: 500
        unit:
          type: string
          description: Unit of measurement
          example: "g"
        image:
          type: string
          format: uri
          description: Ingredient image URL
          example: "https://example.com/ingredient.jpg"

    Nutrition:
      type: object
      properties:
        calories:
          type: number
          description: Calories per serving
          example: 450
        protein:
          type: number
          description: Protein in grams
          example: 20
        fat:
          type: number
          description: Fat in grams
          example: 15
        carbohydrates:
          type: number
          description: Carbohydrates in grams
          example: 60
        fiber:
          type: number
          description: Fiber in grams
          example: 3
        sugar:
          type: number
          description: Sugar in grams
          example: 5

    Ingredient:
      type: object
      properties:
        _id:
          type: string
          description: Ingredient ID
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        userId:
          type: string
          description: User ID who owns this ingredient
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        name:
          type: string
          description: Ingredient name
          example: "Tomato"
        categoryId:
          type: string
          description: Category ID
          example: "vegetables"
        quantity:
          type: string
          description: Quantity
          example: "5"
        unit:
          type: string
          description: Unit of measurement
          example: "pieces"
        expiryDate:
          type: string
          format: date
          description: Expiry date
          example: "2024-12-31"
        image:
          type: string
          format: uri
          description: Ingredient image URL
          example: "https://example.com/tomato.jpg"
        notes:
          type: string
          description: Additional notes
          example: "Fresh tomatoes"
        createdAt:
          type: string
          format: date-time
          description: Creation date
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update date
          example: "2024-01-15T10:30:00Z"

    IngredientCategory:
      type: object
      properties:
        _id:
          type: string
          description: Category ID
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        userId:
          type: string
          description: User ID who owns this category
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        name:
          type: string
          description: Category name
          example: "Vegetables"
        icon:
          type: string
          description: Category icon
          example: "🥕"
        createdAt:
          type: string
          format: date-time
          description: Creation date
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update date
          example: "2024-01-15T10:30:00Z"

    MealPlan:
      type: object
      properties:
        _id:
          type: string
          description: Meal plan ID
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        userId:
          type: string
          description: User ID who owns this meal plan
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        name:
          type: string
          description: Meal plan name
          example: "Monday Healthy Breakfast"
        recipeIds:
          type: array
          items:
            type: string
          description: Array of recipe IDs
          example: ["recipe_123", "recipe_456"]
        notes:
          type: string
          description: Additional notes
          example: "Focus on protein and vegetables"
        date:
          type: string
          format: date-time
          description: Meal plan date
          example: "2025-10-11T08:00:00.000Z"
        createdAt:
          type: string
          format: date-time
          description: Creation date
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update date
          example: "2024-01-15T10:30:00Z"

    Notification:
      type: object
      properties:
        _id:
          type: string
          description: Notification ID
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        userId:
          type: string
          description: User ID who owns this notification
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        title:
          type: string
          description: Notification title
          example: "Ingredient Expiring Soon"
        message:
          type: string
          description: Notification message
          example: "Your tomatoes will expire in 2 days"
        type:
          type: string
          description: Notification type
          example: "expiry_reminder"
        isRead:
          type: boolean
          description: Read status
          example: false
        createdAt:
          type: string
          format: date-time
          description: Creation date
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update date
          example: "2024-01-15T10:30:00Z"

    ShoppingItem:
      type: object
      properties:
        _id:
          type: string
          description: Shopping item ID
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        userId:
          type: string
          description: User ID who owns this item
          example: "64f1a2b3c4d5e6f7g8h9i0j1"
        name:
          type: string
          description: Item name
          example: "Milk"
        status:
          type: string
          enum: [draft, active, completed, cancelled]
          description: Item status
          example: "draft"
        notes:
          type: string
          description: Additional notes
          example: "2% milk"
        createdAt:
          type: string
          format: date-time
          description: Creation date
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update date
          example: "2024-01-15T10:30:00Z"

    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: "Something went wrong"

  responses:
    BadRequest:
      description: Bad request - Invalid input data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Missing required fields"

    Unauthorized:
      description: Unauthorized - Invalid or missing authentication token
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Unauthorized"

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Resource not found"

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error: "Something went wrong"

tags:
  - name: General
    description: General API endpoints
  - name: Admin
    description: Admin management endpoints (requires admin role)
  - name: AI Assistant
    description: AI-powered cooking assistant with tool calling
  - name: Authentication
    description: User authentication endpoints
  - name: Recipes
    description: Recipe search and management
  - name: Ingredients
    description: Ingredient and pantry management
  - name: Ingredient Categories
    description: Ingredient category management
  - name: Meal Plans
    description: Meal planning management
  - name: Notifications
    description: Notification system
  - name: Favorites
    description: User favorites management
  - name: Profile
    description: User profile management
  - name: Shopping
    description: Shopping list management